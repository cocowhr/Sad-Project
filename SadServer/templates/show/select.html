{% extends 'layout.html' %}
{% load staticfiles %}

{% block headjs%}
<script type="text/javascript">
function submit_order()
{
    $("#order_success").fadeIn();
    setTimeout(function(){
            window.location = "{% url 'view.index' %}";
        },2000);
}
$(document).ready(function(){
	$('#listpage').addClass('active');
      $("#order_success").hide();
      $(".date_btn").blur(function() {
            msg = "doctor.name = " + $(this).parent().parent().parent().parent().attr('name') + "\nnew time :" + $(this).parent().parent().children('.date_1').val();
            alert(msg);
      });
      $(".date_2").change(function() {
            msg = "doctor.name = " + $(this).parent().parent().attr('name') + "\nnew time :" +$(this).val();
            alert(msg);
      });
});
</script>
{% endblock %}

{% block headcss %}
{% endblock %}

{% block body %}
<!-- checkout -->
<div class="row">
      <div class="col-md-10 col-md-offset-1">
        <div class="page-header">
            <h3>{{ hospital }} : 选择科室、医生、就诊时间</h3>
        </div>
     </div>
 </div>

<div class="row">
<div class="col-md-10 col-md-offset-1">

<div class="alert alert-success" role="alert" id="order_success">预约成功！请及时支付并打印订单。</div>

<div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">

{% for dept in departments %}
  <div class="panel panel-primary">
    <div class="panel-heading" role="tab" id="heading{{ dept.name }}">
      <h4 class="panel-title">
        <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapse{{ dept.name }}" aria-expanded="true" aria-controls="collapse{{ dept.name }}">
          {{ dept.name }}
        </a>
      </h4>
    </div>
    <div id="collapse{{ dept.name }}" class="panel-collapse collapse" role="tabpanel" aria-labelledby="heading{{ dept.name }}">
      <div class="panel-body">
        <table class="table">
        	<thead>
        		<tr>
        			<th>姓名</th>
        			<th>职称</th>
        			<th>挂号费</th>
        			<th colspan="2">就诊时间选择</th>
                          <th>该时段可预约数</th>
        			<th>预约</th>
        		</tr>
        	</thead>
        	<tbody>
        		{% for doctor in dept.doctors %}
        		<tr name="{{ doctor.name }}">
        			<td width="15%">{{ doctor.name }}</td>
        			<td width="15%">{{ doctor.rank }}</td>
        			<td width="15%">{{ doctor.price }}</td>
        			
				<td width="20%">
				<div class="input-append date form_datetime row">
					<input class="date_1" size="16" type="text" data-format="yyyy-MM-dd" id="date_1" value="" readonly required>
					<span class="add-on"><button class="date_btn btn btn-default btn-warning">选择日期</button></span>
				    	<script type="text/javascript">
					  $(function() {
					    $('.date').datetimepicker({
					      pickTime: false
					    });
					  });
					</script>
				</div>
				</td>
                          <td width="10%">
                            <select class="form-control date_2" id="date_2">
                              <option value="上午">上午</option>
                              <option value="下午">下午</option>
                            </select>
                          </td>
                          <td width="10%">{{ doctor.slot }}</td>
        			<td width="15%"><button class="btn btn-default btn-success" onclick="submit_order()">确认预约</button></td>
        		</tr>
        		{% endfor %}
        	</tbody>
        </table>
      </div>
    </div>
  </div>
{% endfor %}
</div>
</div>

</div>

    {{ block.super }}
{% endblock %}